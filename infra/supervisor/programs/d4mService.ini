; /etc/supervisor/conf.d/d4mService.conf
[program:d4mService]
command=/usr/bin/env bash -lc 'exec julia --project=/opt/d4m --startup-file=no /opt/d4m/main.jl'
directory=/opt/d4m
user=root

autostart=true
autorestart=true
startsecs=2
startretries=3

stopsignal=TERM          ; triggers your atexit/HTTP.shutdown
stopasgroup=true
killasgroup=true
stopwaitsecs=25

environment=JULIA_PROJECT="/opt/d4m",JULIA_NUM_THREADS="auto",PORT="5101",CONFIG_PATH="/opt/d4m/config.toml",JULIA_HISTORY=""

stdout_logfile=/var/log/d4m/service.out.log
stderr_logfile=/var/log/d4m/service.err.log
redirect_stderr=true
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=5